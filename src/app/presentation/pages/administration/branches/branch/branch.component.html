<div class="p-dialog-content">
  <form [formGroup]="FormBranch">
    <div class="formgrid grid">
      <div class="field col-12 sm:col-4">
        <label for="name">Nombre</label>
        <input
          id="name"
          type="text"
          class="w-full"
          pInputText
          formControlName="name"
        />
      </div>
      <div class="field col-12 sm:col-8">
        <label for="message">Mensaje</label>
        <input
          id="message"
          type="text"
          class="w-full"
          pInputText
          formControlName="marqueeMessage"
        />
      </div>
      <div class="field col-12 sm:col-4">
        <label for="platform">Plataforma</label>
        <p-dropdown
          styleClass="w-full"
          inputId="platform"
          [options]="videoPlatforms"
          formControlName="videoPlatform"
          placeholder="Fuente del video"
          (onChange)="onPlatformChange($event.value)"
        />
      </div>
      <div class="field col-12 sm:col-8">
        @if(platform==='Local'){
        <label for="platform">Seleccione un video</label>

        <p-fileUpload
          [customUpload]="true"
          [multiple]="false"
          accept="video/*"
          [maxFileSize]="maxFileSize"
          (onSelect)="onFileSelect($event)"
        >
          <ng-template pTemplate="header"></ng-template>
          <ng-template pTemplate="content">
            @if(videoUrl()){
              <video [src]="videoUrl()"  height="200" controls></video> 
            }
            <p-button
              icon="pi pi-times"
             
              [outlined]="true"
              [rounded]="true"
              severity="danger"
            />
          </ng-template>
        </p-fileUpload>

        } @else {
        <label for="video_id">Identificador del video</label>
        <input
          id="video_id"
          type="text"
          class="w-full"
          pInputText
          formControlName="videoUrl"
        />
        }
      </div>
    </div>
  </form>

  <p-dropdown
    #dropdown
    placeholder="Buscar un servicio"
    filterPlaceholder="Nombre..."
    emptyFilterMessage="Sin resultados"
    emptyMessage="Sin elementos"
    optionLabel="name"
    [style]="{ width: '100%' }"
    [filter]="true"
    [options]="services()"
    (onFilter)="onFilterDropdown($event.filter)"
    (onChange)="addService($event.value)"
  />
  <p>Servicios seleccionados:</p>
  <div class="border-round border-1 my-2 p-3">
    <div class="flex flex-column gap-3">
      @for (service of selectedServices(); track $index) {
      <div class="flex overflow-hidden">
        <div class="flex-grow-1 flex align-items-center">
          <div>{{ service.name }}</div>
        </div>
        <div class="flex-none flex align-items-center justify-content-center">
          <p-button
            icon="pi pi-trash"
            (onClick)="removeService(service)"
          ></p-button>
        </div>
      </div>
      } @empty {
      <span>Sin servicios</span>
      }
    </div>
  </div>
  <div class="card flex justify-content-center">
    <p-toast />
  </div>
</div>
<div class="p-dialog-footer">
  <p-button label="Guardar" [disabled]="!isFormValid" (onClick)="save()" />
</div>
